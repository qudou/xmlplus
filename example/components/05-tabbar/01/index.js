xmlplus("xp", function (xp, $_, t) {
    $_().imports({
        Index: {
            xml: "<Tabbar id='index'>\
                      <TabItem id='home' label='首页'/>\
                      <TabItem id='setting' label='设置'/>\
                      <TabItem id='logs' label='日志'/>\
                      <TabItem id='about' label='关于'/>\
                  </Tabbar>",
            fun: function (sys, items, opts) {
                this.on("switch", (e, target) => console.log(target));
            }
        }
    });
    $_().imports({
        Tabbar: {
            css: "#tabbar { display: table; width: 100%; height: 50px; padding: 0; table-layout: fixed; -webkit-touch-callout: none; }\
                  #tabbar { z-index: 10; background-color: #f7f7f7; backface-visibility: hidden; }",
            xml: "<nav id='tabbar'/>",
            fun: function (sys, items, opts) {
                var sel = this.first();
                this.on("touchend", "./*[@id]", function (e) {
                    sel.val().selected = false;
                    (sel = this).val().selected = true;
                    this.trigger("switch", this.toString());
                });
                if (sel) sel.val().selected = true;
            }
        },
        TabItem: {
            css: "a#tabitem { display: table-cell; overflow: hidden; width: 1%; height: 50px; text-align: center; vertical-align: middle; white-space: nowrap; text-overflow: ellipsis; text-decoration: none; text-align: center; cursor: pointer; fill: currentColor; color: #777; }\
                  #label { display: block; font-size: .75em; overflow: hidden; text-overflow: ellipsis; -webkit-user-select: none; }\
                  a#primary { color: #337ab7; fill: currentColor; }",
            xml: "<a id='tabitem'>\
                      <Icon id='icon'/>\
                      <span id='label'>首页</span>\
                  </a>",
            map: {"attrs": { icon: "id->icon" } },
            fun: function (sys, items, opts) {
                sys.label.text(opts.label);
                function select(bool) {
                    sys.tabitem[bool ? 'addClass' : 'removeClass']("#primary");
                }
                return Object.defineProperty({}, "selected", { set: select});
            }
        },
        Icon: {
            css: "#icon { width: 1.5em; height: 1.5em; display: inline-block; }",
            opt: { icon: "about" },
            xml: "<span id='icon'/>",
            fun: function (sys, items, opts) {
                sys.icon.replace("icon/" + opts.icon).addClass("#icon");
            }
        }
    });
    $_("icon").imports({
        About: {
            xml: "<svg width='48' height='48' viewBox='0 0 1024 1024'>\
                      <path d='M507.577907 23.272727C240.142852 23.272727 23.272727 239.870837 23.272727 507.094323 23.272727 774.535126 240.153546 991.375225 507.577907 991.375225 775.101356 991.375225 991.883087 774.596878 991.883087 507.094323 991.883087 239.824352 775.104293 23.272727 507.577907 23.272727ZM507.577907 69.818182C749.408866 69.818182 945.337633 265.541628 945.337633 507.094323 945.337633 748.890368 749.395172 944.82977 507.577907 944.82977 265.857934 944.82977 69.818182 748.826829 69.818182 507.094323 69.818182 265.590268 265.836128 69.818182 507.577907 69.818182ZM460.17174 368.061568 555.443661 368.061568 555.443661 763.664179 460.17174 763.664179 460.17174 368.061568ZM507.761743 230.268948C534.095946 230.268948 555.397702 251.580874 555.397702 277.899264 555.397702 304.171723 534.072967 325.506614 507.761743 325.506614 481.450515 325.506614 460.17174 304.171723 460.17174 277.899264 460.17174 251.580874 481.450515 230.268948 507.761743 230.268948Z'/>\
                  </svg>"
        },
        Home: {
            xml: "<svg width='48' height='48' viewBox='0 0 1024 1024'>\
                      <path d='M949.082218 519.343245 508.704442 107.590414 68.326667 518.133697c-8.615215 8.03193-9.096169 21.538549-1.043772 30.144554 8.043187 8.599865 21.566178 9.085936 30.175253 1.035586l411.214573-383.337665 411.232992 384.505257c4.125971 3.854794 9.363252 5.760191 14.5903 5.760191 5.690606 0 11.384281-2.260483 15.58393-6.757914C958.138478 540.883841 957.695387 527.388479 949.082218 519.343245L949.082218 519.343245zM949.082218 519.343245M814.699602 527.800871c-11.787464 0-21.349237 9.555633-21.349237 21.327748l0 327.037405L622.552373 876.166023 622.552373 648.662543 394.824789 648.662543l0 227.503481L224.032938 876.166023 224.032938 549.128619c0-11.772115-9.55154-21.327748-21.348214-21.327748-11.802814 0-21.35333 9.555633-21.35333 21.327748l0 369.691877 256.19494 0L437.526333 691.318038l142.329613 0 0 227.502457 256.1888 0L836.044746 549.128619C836.045769 537.356504 826.481949 527.800871 814.699602 527.800871L814.699602 527.800871zM814.699602 527.800871M665.254941 222.095307l128.095423 0 0 113.74867c0 11.789511 9.562796 21.332864 21.349237 21.332864 11.783371 0 21.346167-9.543354 21.346167-21.332864L836.045769 179.439812 665.254941 179.439812c-11.789511 0-21.35333 9.538237-21.35333 21.327748C643.900587 212.554 653.464407 222.095307 665.254941 222.095307L665.254941 222.095307zM665.254941 222.095307'/>\
                  </svg>"
        },
        Logs: {
            xml: "<svg width='48' height='48' viewBox='0 0 1024 1024'>\
                    <path d='M352 256c17.664 0 32-14.304 32-32L384 96c0-17.664-14.336-32-32-32s-32 14.336-32 32l0 128C320 241.696 334.336 256 352 256z'/>\
                    <path d='M512 256c17.664 0 32-14.304 32-32L544 96c0-17.664-14.336-32-32-32s-32 14.336-32 32l0 128C480 241.696 494.336 256 512 256z'/>\
                    <path d='M416 125.344l32 0 0 64-32 0 0-64Z'/>\
                    <path d='M576 125.344l32 0 0 64-32 0 0-64Z'/>\
                    <path d='M800 125.344l-64 0 0 64 64 0c17.664 0 32 14.368 32 32l0 576c0 17.664-14.336 32-32 32L224 829.344c-17.632 0-32-14.336-32-32l0-576c0-17.632 14.368-32 32-32l64 0 0-64L224 125.344c-53.024 0-96 42.976-96 96l0 576c0 53.056 42.976 96 96 96l576 0c53.024 0 96-42.944 96-96l0-576C896 168.288 853.024 125.344 800 125.344z'/>\
                    <path d='M672 256c17.664 0 32-14.304 32-32L704 96c0-17.664-14.336-32-32-32-17.696 0-32 14.336-32 32l0 128C640 241.696 654.304 256 672 256z'/>\
                    <path d='M320 415.328l384 0c17.664 0 32-14.336 32-32s-14.336-32-32-32L320 351.328c-17.664 0-32 14.336-32 32S302.304 415.328 320 415.328z'/>\
                    <path d='M704 509.344 320 509.344c-17.664 0-32 14.336-32 32s14.336 32 32 32l384 0c17.664 0 32-14.304 32-32S721.664 509.344 704 509.344z'/>\
                    <path d='M704 673.344 320 673.344c-17.664 0-32 14.336-32 32s14.336 32 32 32l384 0c17.664 0 32-14.336 32-32S721.664 673.344 704 673.344z'/>\
                  </svg>"
        },
        Setting: {
            xml: "<svg width='48' height='48' viewBox='0 0 1024 1024'>\
                    <path d='M512 336.664c-96.68 0-175.336 78.656-175.336 175.336S415.32 687.336 512 687.336 687.336 608.68 687.336 512 608.68 336.664 512 336.664zM512 647.336c-74.624 0-135.336-60.712-135.336-135.336 0-74.624 60.712-135.336 135.336-135.336S647.336 437.376 647.336 512C647.336 586.624 586.624 647.336 512 647.336z'/>\
                    <path d='M868 392l-38.672 0c-2.512-6.696-5.2-13.232-8.048-19.576l27.296-27.296c14.36-14.352 22.264-33.44 22.264-53.744 0-20.304-7.904-39.384-22.264-53.736l-62.216-62.232c-14.36-14.352-33.448-22.256-53.744-22.256s-39.384 7.904-53.744 22.256l-27.32 27.32c-6.456-2.92-12.984-5.64-19.552-8.128L632 156c0-41.904-34.096-76-76-76l-88 0c-41.904 0-76 34.096-76 76l0 38.696c-6.688 2.512-13.216 5.2-19.552 8.04l-27.32-27.32c-14.36-14.352-33.448-22.256-53.744-22.256s-39.384 7.904-53.744 22.256l-62.216 62.224c-14.36 14.352-22.264 33.44-22.264 53.744 0 20.304 7.904 39.384 22.264 53.736l27.312 27.32c-2.84 6.336-5.52 12.872-8.04 19.56L156 392c-41.904 0-76 34.096-76 76l0 88c0 41.904 34.096 76 76 76l38.672 0c2.512 6.696 5.2 13.232 8.048 19.576l-27.296 27.296c-14.36 14.36-22.264 33.448-22.264 53.744s7.904 39.384 22.264 53.744l62.216 62.216c14.36 14.36 33.448 22.264 53.744 22.264s39.384-7.904 53.744-22.264l27.32-27.312c6.464 2.92 12.984 5.64 19.552 8.136l0 38.6c0 41.904 34.096 76 76 76l88 0c41.904 0 76-34.096 76-76l0-38.696c6.688-2.512 13.216-5.192 19.552-8.04l27.32 27.312c14.36 14.36 33.448 22.264 53.744 22.264s39.384-7.904 53.744-22.264l62.216-62.216c14.36-14.36 22.264-33.448 22.264-53.744s-7.904-39.384-22.264-53.744l-27.312-27.32c2.84-6.336 5.52-12.864 8.04-19.552l38.696 0c41.904 0 76-34.096 76-76l0-88C944 426.096 909.904 392 868 392zM904 556c0 19.848-16.152 36-36 36l-67.296 0-4.536 13.72c-4.8 14.52-10.48 28.312-16.872 40.984l-6.52 12.92 47.528 47.528c6.8 6.808 10.544 15.84 10.544 25.464s-3.752 18.656-10.544 25.464l-62.216 62.216c-6.808 6.8-15.84 10.544-25.464 10.544s-18.656-3.752-25.464-10.544l-47.528-47.528-12.92 6.52c-12.672 6.4-26.464 12.08-40.984 16.872L592 800.704l0 67.296c0 19.848-16.152 36-36 36l-88 0c-19.848 0-36-16.152-36-36l0-67.192-13.744-4.52c-13.824-4.56-27.6-10.28-40.936-17.016l-12.92-6.52-47.552 47.552c-6.808 6.8-15.84 10.544-25.464 10.544s-18.656-3.752-25.464-10.544l-62.216-62.216c-6.8-6.808-10.544-15.84-10.544-25.464s3.752-18.656 10.544-25.464l47.52-47.52-6.528-12.92c-6.4-12.656-12.08-26.448-16.88-40.984L223.272 592 156 592c-19.848 0-36-16.152-36-36l0-88c0-19.848 16.152-36 36-36l67.296 0 4.536-13.72c4.8-14.52 10.48-28.312 16.872-40.976l6.528-12.92-47.536-47.544c-6.808-6.8-10.544-15.84-10.544-25.456 0-9.616 3.744-18.656 10.544-25.456l62.216-62.224c6.808-6.8 15.84-10.544 25.464-10.544s18.656 3.744 25.464 10.536l47.528 47.536 12.92-6.528c12.664-6.392 26.456-12.08 40.984-16.88L432 223.288 432 156c0-19.848 16.152-36 36-36l88 0c19.848 0 36 16.152 36 36l0 67.192 13.736 4.528c13.848 4.568 27.624 10.296 40.944 17.016l12.92 6.52 47.552-47.552c6.808-6.8 15.84-10.544 25.464-10.544s18.656 3.744 25.464 10.536l62.216 62.232c6.808 6.8 10.544 15.832 10.544 25.456 0 9.616-3.744 18.656-10.544 25.456l-47.52 47.52 6.528 12.928c6.408 12.664 12.088 26.448 16.88 40.984L800.728 432l67.272 0c19.848 0 36 16.152 36 36L904 556z'/>\
                  </svg>"
        }
    });
});